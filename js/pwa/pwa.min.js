let deferredPrompt,installBtn,installRejector,enableDownload=!1;window.addEventListener("load",()=>{console.log("PWA ready!");let e=localStorage.getItem("PWA_installed"),l=localStorage.getItem("installDismissed");installBtn=document.querySelector("#pwa-install-btn"),installRejector=document.querySelector("#pwa-dismiss-btn"),window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),deferredPrompt=t,console.log("Prepared"),e||(window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone||"true"===localStorage.getItem("PWA_installed")?(localStorage.setItem("PWA_installed","true"),e=localStorage.getItem("PWA_installed")):(localStorage.removeItem("PWA_installed"),document.querySelector("#pwa-install").classList.remove("display"),e=!1)),e&&"false"!=e||l&&"false"!=l?console.log("Installed before or install dismissed"):(enableDownload=!0,installRejector.addEventListener("click",()=>{localStorage.setItem("installDismissed","true"),document.querySelector("#pwa-install").classList.remove("display")}),installBtn.addEventListener("click",()=>{console.log("Installing..."),deferredPrompt.prompt(),deferredPrompt.userChoice.then(e=>{"accepted"===e.outcome?console.log("User accepted the install prompt"):console.log("User dismissed the install prompt")}),enableDownload=!1}))}),window.addEventListener("appinstalled",e=>{deferredPrompt=null,console.log("👍","appinstalled",e),localStorage.setItem("PWA_installed","true")})});