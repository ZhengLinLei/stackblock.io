let deferredPrompt,enableDownload=!1,installBtn,installRejector;function checkEnvironment(){let e;return e=window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone||"true"===localStorage.getItem("PWA_installed")?(localStorage.setItem("PWA_installed","true"),localStorage.getItem("PWA_installed")):(localStorage.removeItem("PWA_installed"),document.querySelector("#pwa-install").classList.remove("display"),!1)}window.addEventListener("load",()=>{console.log("PWA ready!");let t=localStorage.getItem("PWA_installed"),l=localStorage.getItem("installDismissed");installBtn=document.querySelector("#pwa-install-btn"),(installRejector=document.querySelector("#pwa-dismiss-btn")).addEventListener("click",()=>{localStorage.setItem("installDismissed","true"),document.querySelector("#pwa-install").classList.remove("display")}),window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),deferredPrompt=e,console.log("Prepared"),(t=t||checkEnvironment())&&"false"!=t||l&&"false"!=l?console.log("Installed before or install dismissed"):(enableDownload=!0,installBtn.addEventListener("click",()=>{console.log("Installing..."),deferredPrompt.prompt(),deferredPrompt.userChoice.then(e=>{"accepted"===e.outcome?console.log("User accepted the install prompt"):console.log("User dismissed the install prompt")}),enableDownload=!1}))}),navigator.userAgent.match(/(iPad|iPhone|iPod)/g)&&navigator.userAgent.match(/(Safari)/g)&&(enableDownload=!0,enableDownload=!checkEnvironment()),window.addEventListener("appinstalled",e=>{deferredPrompt=null,console.log("👍","appinstalled",e),localStorage.setItem("PWA_installed","true")})});