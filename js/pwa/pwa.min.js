let deferredPrompt,installBtn,enableDownload=!1;window.addEventListener("load",()=>{console.log("PWA ready!");let e=localStorage.getItem("PWA_installed");installBtn=document.querySelector("#pwa-install-btn"),window.addEventListener("beforeinstallprompt",l=>{l.preventDefault(),deferredPrompt=l,console.log("Prepared"),e||(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: fullscreen)").matches||!0===window.navigator.standalone||"true"===localStorage.getItem("PWA_installed"))&&(localStorage.setItem("PWA_installed","true"),e=localStorage.getItem("PWA_installed")),e||"true"==e?(enableDownload=!0,installBtn.addEventListener("click",()=>{console.log("Installing..."),deferredPrompt.prompt(),deferredPrompt.userChoice.then(e=>{"accepted"===e.outcome?console.log("User accepted the install prompt"):console.log("User dismissed the install prompt")}),enableDownload=!1,installBtn.classList.remove("display")})):console.log("Installed before")}),window.addEventListener("appinstalled",e=>{deferredPrompt=null,console.log("👍","appinstalled",e),localStorage.setItem("PWA_installed","true")})});